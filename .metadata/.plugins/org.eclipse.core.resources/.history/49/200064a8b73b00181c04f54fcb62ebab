package test;

import java.util.HashMap;
import java.util.Objects;

import org.apache.http.util.Args;

import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.JSONObject;
import com.dr.common.SecurityUtils;
import com.thirdparty.data.HttpResponseEntity;
import com.thirdparty.http.HttpApiUtils;

import cn.jiguang.common.utils.Nullable;

public class WpsTest {

	public static void main(String[] args) {
		String msg = callbackReward("1907313",null,"qcz_zhuce_reward",null,"nZDbaRkOxyjJxgRL8SeDnoM9MZKd");
		System.out.println(msg);

	}
	
	 final static String URL = "https://vip.wps.cn";
	    @Nullable
	   public static String getSignature(String parameter) {
	        Args.notEmpty(parameter, "parameter is null");
	        String result = SecurityUtils.MD5(parameter);
	        if (result != null) {
	            return result.toLowerCase();
	        }
	        return null;
	    }
	
	 public static String callbackReward(final String userId, final String extra, final String type, final String phone, final String key) {
		 HttpApiUtils httpApiUtils = new HttpApiUtils();
	        final String url = URL + "/task/api/reward";
	        final Integer size = 12;
	        final HashMap<String, Object> parameters = new HashMap<>(size);
	        final String succeed = "ok";
	        parameters.put("userid", userId);
	        parameters.put("offer_type", type);
	        parameters.put("pass", getSignature(userId + type + key));
	        parameters.put("extra", extra);
	        parameters.put("mobile", phone);
	        HttpResponseEntity responseEntity = httpApiUtils.post(url, parameters);
	        if (responseEntity.getSucceed()) {
	            final String result = responseEntity.getBodyString();
	            JSONObject object = JSON.parseObject(result);
	            if (Objects.equals(object.get("result"), succeed)) {
	                return result;
	            }
	        }
	        return "";
	    }    

}
